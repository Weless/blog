{"remainingRequest":"/Users/joey/joey/go_project/blog/manager_frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/joey/joey/go_project/blog/manager_frontend/src/views/admin/management.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/joey/joey/go_project/blog/manager_frontend/src/views/admin/management.vue","mtime":1592379437489},{"path":"/Users/joey/joey/go_project/blog/manager_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/joey/joey/go_project/blog/manager_frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/joey/joey/go_project/blog/manager_frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/joey/joey/go_project/blog/manager_frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZvcm1hdERhdGUgfSBmcm9tICJAL3V0aWxzL2Zvcm1hdERhdGUiOwppbXBvcnQgeyBHZXRBcnRpY2xlTGlzdCxSZW1vdmVBcnRpY2xlIH0gZnJvbSAiQC9hcGkvbWFuYWdlbWVudCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRvdGFsOiAwLAogICAgICBwYWdlOiAxLAogICAgICBwYWdlU2l6ZTogMTAsCiAgICAgIGFydGljbGVzOiBbXSwKICAgICAgY29uZmlybVJlbW92ZTogZmFsc2UsCiAgICAgIHJlbW92ZUlkOiAiIgogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBmb3JtYXRBcnRpY2xlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuYXJ0aWNsZXMubWFwKHZhbCA9PiB7CiAgICAgICAgbGV0IGxpc3QgPSB7fTsKICAgICAgICBsaXN0Ll9pZCA9IHZhbC5BcnRpY2xlSWQ7CiAgICAgICAgbGlzdC50aXRsZSA9IHZhbC5UaXRsZTsKICAgICAgICBsaXN0LnRhZyA9IHZhbC5OYW1lCiAgICAgICAgbGlzdC5jcmVhdGVEYXRlID0gZm9ybWF0RGF0ZShuZXcgRGF0ZSh2YWwuQ3JlYXRlVGltZSksICJ5eXl5LU1NLWRkIGhoOm1tIik7CiAgICAgICAgbGlzdC51cGRhdGVEYXRlID0gZm9ybWF0RGF0ZShuZXcgRGF0ZSh2YWwuVXBkYXRlZEF0KSwgInl5eXktTU0tZGQgaGg6bW0iKTsKICAgICAgICAvLyBsaXN0Lmxhc3REYXRlID0gZm9ybWF0RGF0ZSgKICAgICAgICAvLyAgIG5ldyBEYXRlKHZhbC5sYXN0RGF0ZSB8fCBsaXN0LmRhdGUpLAogICAgICAgIC8vICAgInl5eXktTU0tZGQgaGg6bW0iCiAgICAgICAgLy8gKTsKICAgICAgICBsaXN0LnZpZXdDb3VudCA9IHZhbC5WaWV3Q291bnQ7CiAgICAgICAgbGlzdC5jb21tZW50Q291bnQgPSB2YWwuQ29tbWVudENvdW50CiAgICAgICAgLy8gbGlzdC50eXBlID0gdmFsLnR5cGUgPT09IDEgPyAi56eB5a+GIiA6ICLlhazlvIAiOwogICAgICAgIHJldHVybiBsaXN0OwogICAgICB9KTsKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWRBcnRpY2xlcygpOwogIH0sCiAgbWV0aG9kczogewogICAgbG9hZEFydGljbGVzKCkgewogICAgICBsZXQgcGFyYW0gPSB7CiAgICAgICAgcGFnZTogdGhpcy5wYWdlLAogICAgICAgIHBhZ2VTaXplOiB0aGlzLnBhZ2VTaXplCiAgICAgIH07CiAgICAgIEdldEFydGljbGVMaXN0KHBhcmFtKS50aGVuKHJlcyA9PiB7CiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKQogICAgICAgIGxldCBkYXRhID0gcmVzLmRhdGE7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24oKSB7CiAgICAgICAgICB0aGlzLnRvdGFsID0gZGF0YS5kYXRhLnRvdGFsOwogICAgICAgICAgdGhpcy5hcnRpY2xlcyA9IGRhdGEuZGF0YS5hcnRpY2xlTGlzdDsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlTW9kaWZ5KGluZGV4KSB7CiAgICAgIGxldCBpZCA9IHRoaXMuYXJ0aWNsZXNbaW5kZXhdLkFydGljbGVJZDsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBwYXRoOiAibW9kaWZ5QXJ0aWNsZSIsIHF1ZXJ5OiB7IF9pZDogaWQgfSB9KTsKICAgIH0sCiAgICAvLyBoYW5kbGVUeXBlQ2hhbmdlKGkpIHsKICAgIC8vICAgbGV0IGlkID0gdGhpcy5hcnRpY2xlc1tpXS5faWQ7CiAgICAvLyAgIGxldCBuZXdEYXRhID0gdGhpcy5hcnRpY2xlc1tpXS50eXBlID09PSAxID8geyB0eXBlOiAwIH0gOiB7IHR5cGU6IDEgfTsKICAgIC8vICAgQ2hhbmdlU3RhdGUoeyBfaWQ6IGlkLCBuZXdEYXRhOiBuZXdEYXRhIH0pCiAgICAvLyAgICAgLnRoZW4oKCkgPT4gewogICAgLy8gICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLliIfmjaLmiJDlip8hIik7CiAgICAvLyAgICAgICB0aGlzLmFydGljbGVzW2ldLnR5cGUgPSAxIF4gdGhpcy5hcnRpY2xlc1tpXS50eXBlOwogICAgLy8gICAgIH0pCiAgICAvLyAgICAgLmNhdGNoKCgpID0+IHt9KTsKICAgIC8vIH0sCiAgICBoYW5kbGVSZW1vdmUoaW5kZXgpIHsKICAgICAgdGhpcy5jb25maXJtUmVtb3ZlID0gdHJ1ZTsKICAgICAgdGhpcy5yZW1vdmVJZCA9IHRoaXMuYXJ0aWNsZXNbaW5kZXhdLkFydGljbGVJZDsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy5yZW1vdmVJZCkKICAgICAgCiAgICB9LAogICAgZGlhbG9nQ2xpY2tPaygpIHsKICAgICAgdGhpcy5jb25maXJtUmVtb3ZlID0gZmFsc2U7CiAgICAgIAogICAgICBSZW1vdmVBcnRpY2xlKHsgYXJ0aWNsZUlkOiB0aGlzLnJlbW92ZUlkIH0pCiAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLliKDpmaTmiJDlip8hIik7CiAgICAgICAgICB0aGlzLmxvYWRBcnRpY2xlcygpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKCgpID0+IHt9KTsKICAgIH0sCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgewogICAgICB0aGlzLnBhZ2UgPSB2YWw7CiAgICAgIHRoaXMubG9hZEFydGljbGVzKCk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["management.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0FA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"management.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\n  <div class=\"management\">\n    <el-table :data=\"formatArticles\" border>\n      <el-table-column\n        align=\"center\"\n        fixed\n        prop=\"title\"\n        label=\"标题\"\n        min-width=\"200\"\n      ></el-table-column>\n      <el-table-column\n        align=\"center\"\n        prop=\"tag\"\n        label=\"标签\"\n        min-width=\"100\"\n      ></el-table-column>\n      <el-table-column\n        align=\"center\"\n        prop=\"createDate\"\n        label=\"创建时间\"\n        min-width=\"120\"\n      ></el-table-column>\n      <el-table-column\n        align=\"center\"\n        prop=\"updateDate\"\n        label=\"最后编辑时间\"\n        min-width=\"120\"\n      ></el-table-column>\n      <el-table-column\n        align=\"center\"\n        prop=\"viewCount\"\n        label=\"阅读量\"\n        min-width=\"80\"\n      ></el-table-column>\n      <el-table-column\n        align=\"center\"\n        prop=\"commentCount\"\n        label=\"评论数\"\n        min-width=\"80\"\n      ></el-table-column>\n      <el-table-column\n        align=\"center\"\n        fixed=\"right\"\n        label=\"编辑\"\n        min-width=\"200\"\n      >\n        <template slot-scope=\"scope\">\n          <el-button\n            type=\"primary\"\n            size=\"small\"\n            @click=\"handleModify(scope.$index)\"\n            >编辑</el-button\n          >\n          <!-- <el-button\n            type=\"primary\"\n            size=\"small\"\n            @click=\"handleTypeChange(scope.$index)\"\n            >切换</el-button\n          > -->\n          <el-button\n            type=\"error\"\n            size=\"small\"\n            @click=\"handleRemove(scope.$index)\"\n            >删除</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"page\">\n      <el-pagination\n        background\n        prev-text=\"上一页\"\n        next-text=\"下一页\"\n        layout=\"prev, pager, next\"\n        :total=\"total\"\n        :page-size=\"pageSize\"\n        @current-change=\"handleCurrentChange\"\n      ></el-pagination>\n    </div>\n    <el-dialog title=\"提示\" :visible.sync=\"confirmRemove\" width=\"30%\">\n      <span>确定删除吗？</span>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"confirmRemove = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"dialogClickOk\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { formatDate } from \"@/utils/formatDate\";\nimport { GetArticleList,RemoveArticle } from \"@/api/management\";\n\nexport default {\n  data() {\n    return {\n      total: 0,\n      page: 1,\n      pageSize: 10,\n      articles: [],\n      confirmRemove: false,\n      removeId: \"\"\n    };\n  },\n  computed: {\n    formatArticles() {\n      return this.articles.map(val => {\n        let list = {};\n        list._id = val.ArticleId;\n        list.title = val.Title;\n        list.tag = val.Name\n        list.createDate = formatDate(new Date(val.CreateTime), \"yyyy-MM-dd hh:mm\");\n        list.updateDate = formatDate(new Date(val.UpdatedAt), \"yyyy-MM-dd hh:mm\");\n        // list.lastDate = formatDate(\n        //   new Date(val.lastDate || list.date),\n        //   \"yyyy-MM-dd hh:mm\"\n        // );\n        list.viewCount = val.ViewCount;\n        list.commentCount = val.CommentCount\n        // list.type = val.type === 1 ? \"私密\" : \"公开\";\n        return list;\n      });\n    }\n  },\n  created() {\n    this.loadArticles();\n  },\n  methods: {\n    loadArticles() {\n      let param = {\n        page: this.page,\n        pageSize: this.pageSize\n      };\n      GetArticleList(param).then(res => {\n        // console.log(res)\n        let data = res.data;\n        this.$nextTick(function() {\n          this.total = data.data.total;\n          this.articles = data.data.articleList;\n        });\n      });\n    },\n    handleModify(index) {\n      let id = this.articles[index].ArticleId;\n      this.$router.push({ path: \"modifyArticle\", query: { _id: id } });\n    },\n    // handleTypeChange(i) {\n    //   let id = this.articles[i]._id;\n    //   let newData = this.articles[i].type === 1 ? { type: 0 } : { type: 1 };\n    //   ChangeState({ _id: id, newData: newData })\n    //     .then(() => {\n    //       this.$message.success(\"切换成功!\");\n    //       this.articles[i].type = 1 ^ this.articles[i].type;\n    //     })\n    //     .catch(() => {});\n    // },\n    handleRemove(index) {\n      this.confirmRemove = true;\n      this.removeId = this.articles[index].ArticleId;\n      // console.log(this.removeId)\n      \n    },\n    dialogClickOk() {\n      this.confirmRemove = false;\n      \n      RemoveArticle({ articleId: this.removeId })\n        .then(() => {\n          this.$message.success(\"删除成功!\");\n          this.loadArticles();\n        })\n        .catch(() => {});\n    },\n    handleCurrentChange(val) {\n      this.page = val;\n      this.loadArticles();\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.management {\n  padding: 60px 20px;\n  margin: 0 auto;\n  max-width: 1264px;\n  .page {\n    margin-top: 20px;\n  }\n  .btn {\n    margin: 6px 0;\n  }\n}\n</style>\n"]}]}